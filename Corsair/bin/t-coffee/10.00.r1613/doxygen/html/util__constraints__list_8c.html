<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>T-Coffee: util_constraints_list.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>util_constraints_list.c File Reference</h1>
<p>All utilities for the <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>.  
<a href="#_details">More...</a></p>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;sched.h&gt;</code><br/>
<code>#include &quot;io_lib_header.h&quot;</code><br/>
<code>#include &quot;util_lib_header.h&quot;</code><br/>
<code>#include &quot;define_header.h&quot;</code><br/>
<code>#include &quot;dp_lib_header.h&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="util__constraints__list_8c.html#a4789610f29c2539926ec98a67140223e">evaluate_constraint_list_reference</a> (<a class="el" href="structConstraint__list.html">Constraint_list</a> *CL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine maximal constraints for normalisation.  <a href="#a4789610f29c2539926ec98a67140223e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="util__constraints__list_8c.html#a448dfb904a27c273923c4968a064c672">fork_read_n_constraint_list</a> (char **fname, int n_list, char *in_mode, char *mem_mode, char *weight_mode, char *type, FILE *local_stderr, <a class="el" href="structConstraint__list.html">Constraint_list</a> *CL, char *seq_source, int nproc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Distributes the reading process for each input file.  <a href="#a448dfb904a27c273923c4968a064c672"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="util__constraints__list_8c.html#a521d3d0c5498572f86fa9d0888b3f922">read_n_constraint_list</a> (char **fname, int n_list, char *in_mode, char *mem_mode, char *weight_mode, char *type, FILE *local_stderr, <a class="el" href="structConstraint__list.html">Constraint_list</a> *CL, char *seq_source)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read several types of input files and build the library.  <a href="#a521d3d0c5498572f86fa9d0888b3f922"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="util__constraints__list_8c.html#a887d8f521ce7fd9abca25489de4fb159">read_constraint_list</a> (<a class="el" href="structConstraint__list.html">Constraint_list</a> *CL, char *in_fname, char *in_mode, char *mem_mode, char *weight_mode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Central method for reading different types of files.  <a href="#a887d8f521ce7fd9abca25489de4fb159"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structSequence.html">Sequence</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="util__constraints__list_8c.html#acaa0f2350cdd830d21cedacce4c937bd">read_seq_in_n_list</a> (char **fname, int n, char *type, char *SeqMode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reads sequence files and alignments or can extract the sequence from a library.  <a href="#acaa0f2350cdd830d21cedacce4c937bd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="util__constraints__list_8c.html#a4387a79f81d664dd6527ea412dec79e8">extend_constraint_list</a> (<a class="el" href="structConstraint__list.html">Constraint_list</a> *CL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Apply Consistency.  <a href="#a4387a79f81d664dd6527ea412dec79e8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="util__constraints__list_8c.html#ada9422fbce6d31a6b98faeef994671aa">fork_relax_constraint_list</a> (<a class="el" href="structConstraint__list.html">Constraint_list</a> *CL, int njobs, int nproc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">First central step of Consistency evaluation.  <a href="#ada9422fbce6d31a6b98faeef994671aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a588c769cc451ee98d557aef05e7f1664"></a><!-- doxytag: member="util_constraints_list.c::relax_constraint_list" ref="a588c769cc451ee98d557aef05e7f1664" args="(Constraint_list *CL)" -->
<a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="util__constraints__list_8c.html#a588c769cc451ee98d557aef05e7f1664">relax_constraint_list</a> (<a class="el" href="structConstraint__list.html">Constraint_list</a> *CL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Distributes the relaxation, see <a class="el" href="util__constraints__list_8c.html#ada9422fbce6d31a6b98faeef994671aa" title="First central step of Consistency evaluation.">fork_relax_constraint_list</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="util__constraints__list_8c.html#a728a4f56bf44e8dd8e32d903d1ab2992">filter_constraint_list</a> (<a class="el" href="structConstraint__list.html">Constraint_list</a> *CL, int field, int T)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deletes unimportant edges from the <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>.  <a href="#a728a4f56bf44e8dd8e32d903d1ab2992"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="util__constraints__list_8c.html#a01c8291a43effd369ba50210a9863221">weight_constraint_list</a> (<a class="el" href="structConstraint__list.html">Constraint_list</a> *CL, char *seq_weight)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Specify a weight for each sequence in the <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>.  <a href="#a01c8291a43effd369ba50210a9863221"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>All utilities for the <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a4789610f29c2539926ec98a67140223e"></a><!-- doxytag: member="util_constraints_list.c::evaluate_constraint_list_reference" ref="a4789610f29c2539926ec98a67140223e" args="(Constraint_list *CL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structConstraint__list.html">Constraint_list</a>* evaluate_constraint_list_reference </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td>
          <td class="paramname"> <em>CL</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Determine maximal constraints for normalisation. </p>
<p>Sets Constaint_list::max_value to the largest edge weight occuring in the complete <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>, and <a class="el" href="structConstraint__list.html#a5da1a5f45535af53d2a815f84aff2e51" title="Maximum sum of edges going out from a single nucleotide.">Constraint_list::max_ext_value</a> to the largest sum of outgoing edges of all residues. </p>

</div>
</div>
<a class="anchor" id="a4387a79f81d664dd6527ea412dec79e8"></a><!-- doxytag: member="util_constraints_list.c::extend_constraint_list" ref="a4387a79f81d664dd6527ea412dec79e8" args="(Constraint_list *CL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structConstraint__list.html">Constraint_list</a>* extend_constraint_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td>
          <td class="paramname"> <em>CL</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Apply Consistency. </p>
<p>Similar to <a class="el" href="util__constraints__list_8c.html#a588c769cc451ee98d557aef05e7f1664" title="Distributes the relaxation, see fork_relax_constraint_list.">relax_constraint_list</a>, but here even edges that had zero weight before (i.e. that did not exist) will be reweighted. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>CL</em>&nbsp;</td><td>The global <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a> object </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a728a4f56bf44e8dd8e32d903d1ab2992"></a><!-- doxytag: member="util_constraints_list.c::filter_constraint_list" ref="a728a4f56bf44e8dd8e32d903d1ab2992" args="(Constraint_list *CL, int field, int T)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structConstraint__list.html">Constraint_list</a>* filter_constraint_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td>
          <td class="paramname"> <em>CL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>T</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deletes unimportant edges from the <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>. </p>
<p>This function reduces the size of th eConstraint_list, which is useful to speed up calculations such as the extension step, by kicking out all constraints/edges with a weight smaller or equal to a given threshold. Currently there is a hardcoded value of 10 in <a class="el" href="util__constraints__list_8c.html#ada9422fbce6d31a6b98faeef994671aa" title="First central step of Consistency evaluation.">fork_relax_constraint_list</a>, but it can also be invokled before the relaxation by setting the <code>-filter_lib</code> parameter.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>CL</em>&nbsp;</td><td>The global <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a> object. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>field</em>&nbsp;</td><td>Internal, constant number to access the CHUNKS of <a class="el" href="structConstraint__list.html#ab1d38cee44aa8748b481578fd0b280a4" title="Central structure containing the constraints/edges between residues.">Constraint_list::residue_index</a> correctly. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>T</em>&nbsp;</td><td>threshold: Edges with weight smaller or equal to T will be removed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a448dfb904a27c273923c4968a064c672"></a><!-- doxytag: member="util_constraints_list.c::fork_read_n_constraint_list" ref="a448dfb904a27c273923c4968a064c672" args="(char **fname, int n_list, char *in_mode, char *mem_mode, char *weight_mode, char *type, FILE *local_stderr, Constraint_list *CL, char *seq_source, int nproc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structConstraint__list.html">Constraint_list</a> * fork_read_n_constraint_list </td>
          <td>(</td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>in_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>mem_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>weight_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>local_stderr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td>
          <td class="paramname"> <em>CL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>seq_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nproc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Distributes the reading process for each input file. </p>
<p>This function forks the process (using vvfork) of reading several input files into several subroutines. Each of these subroutines will eventually call <a class="el" href="util__constraints__list_8c.html#a887d8f521ce7fd9abca25489de4fb159" title="Central method for reading different types of files.">read_constraint_list</a>, which is the central reading method and recommended reading!</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fname</em>&nbsp;</td><td>The names of the input files </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>n_list</em>&nbsp;</td><td>Number of input files </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>CL</em>&nbsp;</td><td>Points to the global <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a> object </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nproc</em>&nbsp;</td><td>Number of cores to use, per default the output of get_nproc </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ada9422fbce6d31a6b98faeef994671aa"></a><!-- doxytag: member="util_constraints_list.c::fork_relax_constraint_list" ref="ada9422fbce6d31a6b98faeef994671aa" args="(Constraint_list *CL, int njobs, int nproc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structConstraint__list.html">Constraint_list</a> * fork_relax_constraint_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td>
          <td class="paramname"> <em>CL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>njobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nproc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>First central step of Consistency evaluation. </p>
<p>Here we evaluate the consistency of edges in the <a class="el" href="structConstraint__list.html#ab1d38cee44aa8748b481578fd0b280a4" title="Central structure containing the constraints/edges between residues.">Constraint_list::residue_index</a>. This function distributes this process on several cores using vvfork. On each core, the alogrithm looks like this: </p>
<div class="fragment"><pre class="fragment"> <span class="keywordflow">for</span> (A,resA) in [<span class="keyword">set</span> of Sequences] { <span class="comment">// Iterate over Sequences A and all residues in this sequence</span>

     n_resA = len(<a class="code" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>(A,resA)) <span class="comment">// number edges/constraint going out from this residue in sequence A</span>

     for (B, resB, w_resA_resB) in <a class="code" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>(A,resA) { <span class="comment">// Iterate over all matches that can be seen from this residue (usually between 0 and 4 per external sequence ehen using proba_pair)</span>

         edges_from_A [B, resB] = w_resA_resB <span class="comment">// keep in mind outgoing edges from sequence A.</span>
         }

     <span class="keywordflow">for</span> (B, resB, w_resA_resB) in <a class="code" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>(A,resA) {

         n_resB = len(<a class="code" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>(B,resB)) <span class="comment">// number edges/constraint going out from resB in sequence B</span>

         for (C, resC, w_resB_resC) in <a class="code" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>(B,resB) {

             <span class="keywordflow">if</span>( C == A &amp;&amp; resC == resA ) { <span class="comment">// looking back at the same edge</span>

                 score += w_resA_resB
                 }
             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( isset edges_from_A[] ) { <span class="comment">// found a 3-circle!</span>

                 score += MIN (w_resA_resB, w_resB_resC) <span class="comment">// How to weight this consistency? Here we take the minimum.</span>
                 }
             }

         save (A,resA)--(B,resB) = score / MIN(n_resA, n_resB)      <span class="comment">// Now we have a new score for edge resA -- resB. Save it</span>

         }
     unset edges_from_A
     }

 <span class="comment">// when all jobs are finished</span>
 Update CL <span class="keyword">using</span> the <span class="keyword">new</span> scores.
</pre></div><p>During the relaxation step, the new scores are written to a file and updated not before all loops have finished. It is important not to update edges while the computation is still going on - this would lead to unexpected results. </p>
<dl class="note"><dt><b>Note:</b></dt><dd><b>Normalisation:</b> The new score, which is a sum of existing scores, is divided by the minimum of <code>n_resA</code> nad n_resB, which are the numbers of outgoing edges (to all sequences).</dd></dl>
<p>Finally, the Constrint_list is filtered with a hardcoded threshold of 10, see <a class="el" href="util__constraints__list_8c.html#a728a4f56bf44e8dd8e32d903d1ab2992" title="Deletes unimportant edges from the Constraint_list.">filter_constraint_list</a>. </p>
<dl class="attention"><dt><b>Attention:</b></dt><dd>The relaxation differs from the extension in the fact that only previously existing edges are reweighted. Non-existing edges (i.e. edges with zero weight) cannot be created, although they might be highly consistent. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="util__constraints__list_8c.html#a4387a79f81d664dd6527ea412dec79e8" title="Apply Consistency.">extend_constraint_list</a> </dd></dl>

<p><p>Sascha: No filtering please</p>
<p>Sascha: Sum up all weights / probabilities going out from here.</p>
<p>Sascha: Product of probabilities! See ProbCons paper</p>
<p>Sascha: Sum up all weights / probabilities going out from here.</p>
<p>Sascha: Normalized by the product of posterior probabilities</p>
<p>Sascha: Take only nominator, the marginal probability of Aligning A with B through C </p>
</p>

</div>
</div>
<a class="anchor" id="a887d8f521ce7fd9abca25489de4fb159"></a><!-- doxytag: member="util_constraints_list.c::read_constraint_list" ref="a887d8f521ce7fd9abca25489de4fb159" args="(Constraint_list *CL, char *in_fname, char *in_mode, char *mem_mode, char *weight_mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structConstraint__list.html">Constraint_list</a>* read_constraint_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td>
          <td class="paramname"> <em>CL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>in_fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>in_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>mem_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>weight_mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Central method for reading different types of files. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd><p class="startdd">This MUST be documented! Explain what types of input are possible and so on. </p>
<p class="enddd">It should also contain odds that occur when reading several inputs, like keeping the maximum edge weight.</p>
</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>CL</em>&nbsp;</td><td>points to the global Constrain_list object. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>in_fname</em>&nbsp;</td><td>Name of the input file to be read. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a521d3d0c5498572f86fa9d0888b3f922"></a><!-- doxytag: member="util_constraints_list.c::read_n_constraint_list" ref="a521d3d0c5498572f86fa9d0888b3f922" args="(char **fname, int n_list, char *in_mode, char *mem_mode, char *weight_mode, char *type, FILE *local_stderr, Constraint_list *CL, char *seq_source)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structConstraint__list.html">Constraint_list</a>* read_n_constraint_list </td>
          <td>(</td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>in_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>mem_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>weight_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>local_stderr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td>
          <td class="paramname"> <em>CL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>seq_source</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read several types of input files and build the library. </p>
<p>Decides on how many processors to use and redirects to <a class="el" href="util__constraints__list_8c.html#a448dfb904a27c273923c4968a064c672" title="Distributes the reading process for each input file.">fork_read_n_constraint_list</a>, so please follow the link to continue reading. </p>

</div>
</div>
<a class="anchor" id="acaa0f2350cdd830d21cedacce4c937bd"></a><!-- doxytag: member="util_constraints_list.c::read_seq_in_n_list" ref="acaa0f2350cdd830d21cedacce4c937bd" args="(char **fname, int n, char *type, char *SeqMode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSequence.html">Sequence</a>* read_seq_in_n_list </td>
          <td>(</td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>SeqMode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reads sequence files and alignments or can extract the sequence from a library. </p>
<p>This is basically a decision function that calls the appropriate read function depending on the type of the input file. </p>
<dl class="see"><dt><b>See also:</b></dt><dd>main_read_aln to read Alignment files or sequence files </dd>
<dd>
read_seq_in_list to read from a library </dd>
<dd>
several auxiliary functions like aln2seq, seq2unique_name_seq and merge_seq </dd></dl>

</div>
</div>
<a class="anchor" id="a01c8291a43effd369ba50210a9863221"></a><!-- doxytag: member="util_constraints_list.c::weight_constraint_list" ref="a01c8291a43effd369ba50210a9863221" args="(Constraint_list *CL, char *seq_weight)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structConstraint__list.html">Constraint_list</a>* weight_constraint_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structConstraint__list.html">Constraint_list</a> *&nbsp;</td>
          <td class="paramname"> <em>CL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>seq_weight</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Specify a weight for each sequence in the <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a>. </p>
<p>If <code>seq_weight</code> is "t_coffee", weights (see Weights object) are computed according to compute_t_coffee_weight and given to the Constraint_list::W reference. If <code>seq_weight</code> is a file, this function will read the weight file (read_seq_weight). In every other case, all sequence weights are set to 1 and the weight mode Weight::mode is set to "no_seq_weight".</p>
<p>Unless the third case occurs, so whenever you want the sequences to be weighted, the function re_weight_constraint_list takes care of it.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>seq_weight</em>&nbsp;</td><td>can be "t_coffee" or the name of a weight file. </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>CL</em>&nbsp;</td><td>points to the global <a class="el" href="structConstraint__list.html" title="The central data structure (library) containing nearly all information to produce...">Constraint_list</a> object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 28 Sep 2012 for T-Coffee by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
